import os
import colorama
import random

""" Heading """

heading = """
   _____                  _           _____ _     _      _     _ 
  / ____|                | |         / ____| |   (_)    | |   | |
 | |     _ __ _   _ _ __ | |_ ___   | (___ | |__  _  ___| | __| |
 | |    | '__| | | | '_ \| __/ _ \   \___ \| '_ \| |/ _ | |/ _` |
 | |____| |  | |_| | |_) | || (_) |  ____) | | | | |  __| | (_| |
  \_____|_|   \__, | .__/ \__\___/  |_____/|_| |_|_|\___|_|\__,_|
               __/ | |                                           
              |___/|_|      

                        ________      ___    ___ 
                        |\   __  \    |\  \  /  /|
                        \ \  \|\ /_   \ \  \/  / /
                         \ \   __  \   \ \    / / 
                          \ \  \|\  \   \/  /  /  
                           \ \_______\__/  /  /    
                            \|_______|\___/  /     
                                      \|___|/      
                                                
                                                               

            ██    ██ ██████  ████████ ██    ██  ██████ ███████ 
            ██    ██ ██   ██    ██     ██  ██  ██      ██      
            ██    ██ ██████     ██      ████   ██      ███████ 
            ██    ██ ██         ██       ██    ██           ██ 
             ██████  ██         ██       ██     ██████ ███████ 
                                                   
                                                   
        """


""" Encryption """ 

def encrypt(key):

    # show all the files in the current directory
    for file in files:
        if file == 'CryptoShield.py':
            continue
        print(f"\n\n\nFound {colors[random.randint(0, len(colors)-1)] + file} file\n")

        # Encrypt the file

        f = open(file, 'r')
        data = f.read()
        f.close()

        encryptedContent = []

        for line in data.split('\n'):
            encryptedLine = ''
            for letter in line:
                encryptedLine += chr(key + ord(letter))
            encryptedContent.append(encryptedLine)
        
        encryptedData = '\n'.join(line for line in encryptedContent)

        f = open(file, 'w', encoding='utf-8')

        f.write(encryptedData)

        f.close()

        print(colorama.Fore.RED + f"Encrypted {file} file successfully...")



""" Decryption """


def decrypt(key):
    # show all the files in the current directory
    for file in files:
        if file == 'CryptoShield.py':
            continue
        print(f"\n\n\nFound {colors[random.randint(0, len(colors)-1)] + file} file\n")

        # Encrypt the file

        f = open(file, 'r')
        data = f.read()
        f.close()

        decryptedContent = []

        for line in data.split('\n'):
            decryptedLine = ''
            for letter in line:
                decryptedLine += chr(ord(letter) - key)
            decryptedContent.append(decryptedLine)
        
        decryptedData = '\n'.join(line for line in decryptedContent)

        f = open(file, 'w', encoding='utf-8')

        f.write(decryptedData)

        f.close()

        print(colorama.Fore.GREEN + f"Decrypted {file} file successfully...")



# set auto reset to true for font color
colorama.init(autoreset=True)


# store all the possible colors in an array
colors = [
    colorama.Fore.BLUE , colorama.Fore.CYAN, colorama.Fore.LIGHTMAGENTA_EX, 
    colorama.Fore.WHITE, colorama.Fore.YELLOW
          ]


# list all the files in the current directory
files = os.listdir()


# encryption key
key = random.randint(1, 26)

# poll
print(colorama.Fore.GREEN + heading)

option = input(colorama.Fore.RED + 'type 1 for encryption, 2 for decryption: ')

if option == '1':
    print(colorama.Fore.YELLOW + '\n\nEncryption Started.....')
    needKey = input('Do you have encryption key(yes/no): ') == 'yes'
    key = int(input(colorama.Fore.MAGENTA + 'Enter the Key (1 to 26) :')) if needKey else key
    print(f"Encryption key = {key}")
    encrypt(key)
else:
    print(colorama.Fore.YELLOW + '\n\nDecryption Started.....')
    needKey = input('Do you have decryption key(yes/no): ') == 'yes'
    key = int(input(colorama.Fore.MAGENTA + 'Enter the Key (1 to 26) :')) if needKey else key
    print(f"Encryption key = {key}")
    decrypt(key)


